<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marist Boys - MwalimuHub</title>
    <link rel="icon" href="assets/Marist_Brothers_monogram.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="js/login.js" defer></script>
</head>
<body>

    <div id="navbar-placeholder" style="width: 100%;"></div>

    <div id="navbar-spacer"></div>

    <div class="header-image"></div>

    <header class="content-header">
        <div class="logo-title">
            <img src="assets/Marist_Brothers_monogram.svg" alt="Logo Marist" class="logo">
            <div>
                <h1>Marist Boys</h1>
                <h2>MwalimuHub</h2>
                <p>Digital Platform for Mwanza Marist Secondary School Teachers</p>
            </div>
        </div>
        <button id="theme-toggle">ðŸŒž / ðŸŒ™</button>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="google-button-wrapper flex justify-center mt-4 hidden"> 
            <div id="g_id_onload"
                 data-client_id="651622332732-hqg898c50786ii5rpa4iieo43gb6kmc8.apps.googleusercontent.com"
                 data-callback="handleCredentialResponse"
                 data-auto_prompt="false">
            </div>
            <div class="g_id_signin google-button"
                 data-type="standard"
                 data-size="large"
                 data-theme="outline"
                 data-text="sign_in_with"
                 data-shape="rectangular"
                 data-logo_alignment="left">
            </div>
        </div>
        
        <div id="spinner" class="spinner"></div>
        <div id="result" class="mt-4 text-gray-700"></div>

        <section id="authenticated-content" class="mt-8 p-6 bg-white rounded-lg shadow-md hidden">
            <h3 class="text-xl font-bold mb-4">Contenuto Riservato agli Utenti Autorizzati</h3>
            <p>Questo Ã¨ il contenuto che appare solo dopo che l'utente ha effettuato il login e la sua email Ã¨ stata verificata nella whitelist.</p>
            <p id="welcome-message" class="mt-4 text-lg font-semibold text-blue-600"></p>
        </section>

        <div class="flex justify-center space-x-4 mt-8">
            <button id="simulate-login-button" class="bg-blue-500 text-white px-6 py-3 rounded-md hover:bg-blue-600 transition-colors duration-200">Simula Login</button>
            <button id="simulate-logout-button" class="bg-gray-500 text-white px-6 py-3 rounded-md hover:bg-gray-600 transition-colors duration-200">Simula Logout</button>
        </div>
    </main>

    <script>
        // Funzione per caricare la navbar
        async function loadNavbar() {
            try {
                const response = await fetch('components/navbar.html'); 
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const navbarHtml = await response.text();
                document.getElementById('navbar-placeholder').innerHTML = navbarHtml;
                // Una volta che la navbar Ã¨ stata caricata nel DOM, inizializza i suoi listener
                if (window.initializeNavbarElements) {
                    window.initializeNavbarElements();
                }

                // Carica lo stato di login iniziale dopo che la navbar Ã¨ stata caricata e inizializzata
                let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                let userData = null;
                if (isLoggedIn) {
                    try {
                        userData = JSON.parse(localStorage.getItem('userData'));
                    } catch (e) {
                        console.error("Errore nel parsing di userData da localStorage:", e);
                        localStorage.removeItem('isLoggedIn');
                        localStorage.removeItem('userData');
                        isLoggedIn = false;
                    }
                }
                updateUIForLoginState(isLoggedIn, userData);

            } catch (error) {
                console.error("Errore nel caricamento della navbar:", error);
            }
        }

        // Carica la navbar quando il DOM Ã¨ completamente caricato
        document.addEventListener('DOMContentLoaded', loadNavbar);
    </script>

</body>
</html>
